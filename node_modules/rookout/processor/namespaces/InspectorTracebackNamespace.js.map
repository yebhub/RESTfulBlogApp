{"version":3,"sources":["../../../../src/processor/namespaces/InspectorTracebackNamespace.js"],"names":["variant_pb","require","InspectorTracebackNamespace","Namespace","constructor","inspector","callFrames","depth","readKey","key","InspectorFrameNamespace","callMethod","name","args","JSObjectNamespace","dump","variant","namespaceSerializer","setVariantType","Variant","Type","VARIANT_TRACEBACK","traceback","Traceback","i","position","resolvePosition","frame","CodeObject","setName","function","setFilename","filename","setModule","setNameIndexInCache","getStringIndexInCache","setFilenameIndexInCache","setModuleIndexInCache","setLineno","line","addLocations","setTraceback"],"mappings":";;;;;;;AAGA;;AACA;;AACA;;;;AAJA,MAAMA,UAAU,GAAGC,OAAO,CAAC,2BAAD,CAA1B;;AAMO,MAAMC,2BAAN,SAA0CC,kBAA1C,CAAoD;AAEvDC,EAAAA,WAAW,CAACC,SAAD,EAAYC,UAAZ,EAAwBC,KAAxB,EAA+B;AACtC;AAEA,SAAKF,SAAL,GAAiBA,SAAjB;AACA,SAAKC,UAAL,GAAkBA,UAAlB;AACA,SAAKC,KAAL,GAAaA,KAAb;AACH;;AAEDC,EAAAA,OAAO,CAACC,GAAD,EAAM;AACT,WAAO,IAAIC,gCAAJ,CAA4B,KAAKL,SAAjC,EAA4C,KAAKC,UAAL,CAAgBG,GAAhB,CAA5C,CAAP;AACH;;AAEDE,EAAAA,UAAU,CAACC,IAAD,EAAOC,IAAP,EAAa;AACnB,YAAQD,IAAR;AACI,WAAK,MAAL;AACI,eAAO,IAAIE,0BAAJ,CAAsB,KAAKP,KAA3B,CAAP;;AACJ;AACI,eAAO,MAAMI,UAAN,CAAiBC,IAAjB,EAAuBC,IAAvB,CAAP;AAJR;AAMH;;AAEDE,EAAAA,IAAI,CAACC,OAAD,EAAUC,mBAAmB,GAAG,IAAhC,EAAsC;AACtCD,IAAAA,OAAO,CAACE,cAAR,CAAuBlB,UAAU,CAACmB,OAAX,CAAmBC,IAAnB,CAAwBC,iBAA/C;AAEA,QAAIC,SAAS,GAAG,IAAItB,UAAU,CAACmB,OAAX,CAAmBI,SAAvB,EAAhB;;AAEA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKjB,KAAzB,EAAgC,EAAEiB,CAAlC,EAAqC;AACjC,YAAMC,QAAQ,GAAG,KAAKpB,SAAL,CAAeqB,eAAf,CAA+B,KAAKpB,UAAL,CAAgBkB,CAAhB,CAA/B,CAAjB;AAEA,UAAIG,KAAK,GAAG,IAAI3B,UAAU,CAACmB,OAAX,CAAmBS,UAAvB,EAAZ;;AACA,UAAIX,mBAAmB,KAAK,IAA5B,EAAkC;AAC9BU,QAAAA,KAAK,CAACE,OAAN,CAAcJ,QAAQ,CAACK,QAAvB;AACAH,QAAAA,KAAK,CAACI,WAAN,CAAkBN,QAAQ,CAACO,QAA3B;AACAL,QAAAA,KAAK,CAACM,SAAN,CAAgBR,QAAQ,CAACO,QAAzB;AACH,OAJD,MAIO;AACHL,QAAAA,KAAK,CAACO,mBAAN,CAA0BjB,mBAAmB,CAACkB,qBAApB,CAA0CV,QAAQ,CAACK,QAAnD,CAA1B;AACAH,QAAAA,KAAK,CAACS,uBAAN,CAA8BnB,mBAAmB,CAACkB,qBAApB,CAA0CV,QAAQ,CAACO,QAAnD,CAA9B;AACAL,QAAAA,KAAK,CAACU,qBAAN,CAA4BpB,mBAAmB,CAACkB,qBAApB,CAA0CV,QAAQ,CAACO,QAAnD,CAA5B;AACH;;AACDL,MAAAA,KAAK,CAACW,SAAN,CAAgBb,QAAQ,CAACc,IAAzB;AAEAjB,MAAAA,SAAS,CAACkB,YAAV,CAAuBb,KAAvB;AACH;;AAEDX,IAAAA,OAAO,CAACyB,YAAR,CAAqBnB,SAArB;AACH;;AA/CsD","sourcesContent":["\r\nconst variant_pb = require('../../protobuf/variant_pb');\r\n\r\nimport Namespace from \"./Namespace\";\r\nimport InspectorFrameNamespace from \"./InspectorFrameNamespace\";\r\nimport JSObjectNamespace from \"./JSObjectNamespace\";\r\n\r\nexport class InspectorTracebackNamespace extends Namespace {\r\n\r\n    constructor(inspector, callFrames, depth) {\r\n        super();\r\n\r\n        this.inspector = inspector;\r\n        this.callFrames = callFrames;\r\n        this.depth = depth;\r\n    }\r\n\r\n    readKey(key) {\r\n        return new InspectorFrameNamespace(this.inspector, this.callFrames[key]);\r\n    }\r\n\r\n    callMethod(name, args) {\r\n        switch (name) {\r\n            case \"size\":\r\n                return new JSObjectNamespace(this.depth);\r\n            default:\r\n                return super.callMethod(name, args);\r\n        }\r\n    }\r\n\r\n    dump(variant, namespaceSerializer = null) {\r\n        variant.setVariantType(variant_pb.Variant.Type.VARIANT_TRACEBACK);\r\n\r\n        let traceback = new variant_pb.Variant.Traceback();\r\n\r\n        for (let i = 0; i < this.depth; ++i) {\r\n            const position = this.inspector.resolvePosition(this.callFrames[i]);\r\n\r\n            let frame = new variant_pb.Variant.CodeObject();\r\n            if (namespaceSerializer === null) {\r\n                frame.setName(position.function);\r\n                frame.setFilename(position.filename);\r\n                frame.setModule(position.filename);\r\n            } else {\r\n                frame.setNameIndexInCache(namespaceSerializer.getStringIndexInCache(position.function));\r\n                frame.setFilenameIndexInCache(namespaceSerializer.getStringIndexInCache(position.filename));\r\n                frame.setModuleIndexInCache(namespaceSerializer.getStringIndexInCache(position.filename));\r\n            }\r\n            frame.setLineno(position.line);\r\n\r\n            traceback.addLocations(frame);\r\n        }\r\n\r\n        variant.setTraceback(traceback);\r\n    }\r\n}\r\n\r\n"],"file":"InspectorTracebackNamespace.js"}