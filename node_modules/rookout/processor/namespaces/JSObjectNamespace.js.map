{"version":3,"sources":["../../../../src/processor/namespaces/JSObjectNamespace.js"],"names":["STRICT_MAX_DEPTH","STRICT_MAX_WIDTH","STRICT_MAX_COLLECTION_DEPTH","STRICT_MAX_STRING","DEFAULT_MAX_DEPTH","DEFAULT_MAX_WIDTH","DEFAULT_MAX_COLLECTION_DEPTH","DEFAULT_MAX_STRING","TOLERANT_MAX_DEPTH","TOLERANT_MAX_WIDTH","TOLERANT_MAX_COLLECTION_DEPTH","TOLERANT_MAX_STRING","UNLIMITED_STRING","UNLIMITED_COLLECTION_WIDTH","JSObjectNamespace","Namespace","constructor","object","dumpConfig","obj","defaultDumpConfig","callMethod","name","args","Array","length","String","undefined","Object","keys","depth","parseInt","isNaN","RookInvalidMethodArguments","width","maxCollectionDepth","maxString","dumpConfigs","toLowerCase","readAttribute","hasOwnProperty","RookAttributeNotFound","readKey","key","isDefaultDumpConfig","maxDepth","maxWidth","strictDumpConfig","tolerantDumpConfig","tailorDumpConfig"],"mappings":"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","sourcesContent":["\"use strict\";\r\n\r\nimport Namespace from './Namespace';\r\n\r\nimport {RookAttributeNotFound, RookInvalidMethodArguments} from \"../../exceptions\";\r\n\r\nexport const STRICT_MAX_DEPTH = 2;\r\nexport const STRICT_MAX_WIDTH = 5;\r\nexport const STRICT_MAX_COLLECTION_DEPTH = 1;\r\nexport const STRICT_MAX_STRING = 128;\r\n\r\nexport const DEFAULT_MAX_DEPTH = 3;\r\nexport const DEFAULT_MAX_WIDTH = 10;\r\nexport const DEFAULT_MAX_COLLECTION_DEPTH = 2;\r\nexport const DEFAULT_MAX_STRING = 512;\r\n\r\nexport const TOLERANT_MAX_DEPTH = 5;\r\nexport const TOLERANT_MAX_WIDTH = 50;\r\nexport const TOLERANT_MAX_COLLECTION_DEPTH = 4;\r\nexport const TOLERANT_MAX_STRING = 4 * 1024;\r\n\r\nexport const UNLIMITED_STRING = 64 * 1024;\r\nexport const UNLIMITED_COLLECTION_WIDTH = 100;\r\n\r\n\r\nexport default class JSObjectNamespace extends Namespace {\r\n    constructor(object, dumpConfig=null) {\r\n        super();\r\n\r\n        this.obj = object;\r\n\r\n        if (dumpConfig === null) {\r\n            this.dumpConfig = JSObjectNamespace.defaultDumpConfig();\r\n        } else {\r\n            this.dumpConfig = dumpConfig;\r\n        }\r\n    }\r\n\r\n    callMethod(name, args) {\r\n        switch (name) {\r\n            case \"type\":\r\n                return new JSObjectNamespace(typeof this.obj);\r\n\r\n            case \"size\":\r\n                if (this.obj instanceof Array) {\r\n                    return new JSObjectNamespace(this.obj.length);\r\n                }\r\n\r\n                if (typeof this.obj === 'string' || this.obj instanceof String) {\r\n                    return new JSObjectNamespace(this.obj.length);\r\n                }\r\n\r\n                if (this.obj === undefined || this.obj === null) {\r\n                    return new JSObjectNamespace(0);\r\n                }\r\n\r\n                return new JSObjectNamespace(Object.keys(this.obj).length);\r\n\r\n            case \"depth\":\r\n                this.dumpConfig.depth = parseInt(args);\r\n                if (isNaN(this.dumpConfig.depth)) {\r\n                    throw new RookInvalidMethodArguments('depth()', args);\r\n                }\r\n                return this;\r\n\r\n            case \"width\":\r\n                this.dumpConfig.width = parseInt(args);\r\n                if (isNaN(this.dumpConfig.width)) {\r\n                    throw new RookInvalidMethodArguments('width()', args);\r\n                }\r\n                return this;\r\n\r\n            case \"collection_dump\":\r\n                this.dumpConfig.maxCollectionDepth = parseInt(args);\r\n                if (isNaN(this.dumpConfig.maxCollectionDepth)) {\r\n                    throw new RookInvalidMethodArguments('collection_dump()', args);\r\n                }\r\n                return this;\r\n\r\n            case \"string\":\r\n                this.dumpConfig.maxString = parseInt(args);\r\n                if (isNaN(this.dumpConfig.maxString)) {\r\n                    throw new RookInvalidMethodArguments('string()', args);\r\n                }\r\n                return this;\r\n\r\n            case \"limit\":\r\n                this.dumpConfig = dumpConfigs[args.toLowerCase()];\r\n                if (this.dumpConfig === undefined) {\r\n                    throw new RookInvalidMethodArguments('limit()', args);\r\n                }\r\n                return this;\r\n\r\n            default:\r\n                return super.callMethod(name, args);\r\n        }\r\n    }\r\n\r\n    readAttribute(name) {\r\n        if (this?.obj?.hasOwnProperty(name)) {\r\n            let obj = new JSObjectNamespace(this.obj[name]);\r\n            obj.dumpConfig = this.dumpConfig;\r\n\r\n            return obj;\r\n        }\r\n\r\n        throw new RookAttributeNotFound(name);\r\n    }\r\n\r\n    readKey(key) {\r\n        return this.readAttribute(key);\r\n    }\r\n\r\n    isDefaultDumpConfig() {\r\n        return this.dumpConfig.maxDepth === DEFAULT_MAX_DEPTH &&\r\n            this.dumpConfig.maxWidth === DEFAULT_MAX_WIDTH &&\r\n            this.dumpConfig.maxCollectionDepth === DEFAULT_MAX_COLLECTION_DEPTH &&\r\n            this.dumpConfig.maxString === DEFAULT_MAX_STRING;\r\n    }\r\n\r\n    static strictDumpConfig() {\r\n        return { maxDepth: STRICT_MAX_DEPTH,\r\n            maxWidth: STRICT_MAX_WIDTH,\r\n            maxCollectionDepth: STRICT_MAX_COLLECTION_DEPTH,\r\n            maxString: STRICT_MAX_STRING};\r\n    }\r\n\r\n    static defaultDumpConfig() {\r\n        return { maxDepth: DEFAULT_MAX_DEPTH,\r\n            maxWidth: DEFAULT_MAX_WIDTH,\r\n            maxCollectionDepth: DEFAULT_MAX_COLLECTION_DEPTH,\r\n            maxString: DEFAULT_MAX_STRING};\r\n    }\r\n\r\n    static tolerantDumpConfig() {\r\n        return { maxDepth: TOLERANT_MAX_DEPTH,\r\n            maxWidth: TOLERANT_MAX_WIDTH,\r\n            maxCollectionDepth: TOLERANT_MAX_COLLECTION_DEPTH,\r\n            maxString: TOLERANT_MAX_STRING};\r\n    }\r\n\r\n    static tailorDumpConfig(obj) {\r\n        if (typeof obj === 'string' || obj instanceof String) {\r\n            return { maxDepth: 1, maxWidth: 0, maxCollectionDepth: 0, maxString: UNLIMITED_STRING};\r\n        } else if (obj instanceof Array) {\r\n            return { maxDepth: DEFAULT_MAX_DEPTH,\r\n                maxWidth: UNLIMITED_COLLECTION_WIDTH,\r\n                maxCollectionDepth: DEFAULT_MAX_COLLECTION_DEPTH,\r\n                maxString: DEFAULT_MAX_STRING};\r\n        } else {\r\n            return JSObjectNamespace.tolerantDumpConfig();\r\n        }\r\n    }\r\n}\r\n\r\nexport const dumpConfigs = {\r\n    '': JSObjectNamespace.defaultDumpConfig(),\r\n    'strict': JSObjectNamespace.strictDumpConfig(),\r\n    'default': JSObjectNamespace.defaultDumpConfig(),\r\n    'tolerant': JSObjectNamespace.tolerantDumpConfig()};\r\n"],"file":"JSObjectNamespace.js"}